<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Side Navigation Bar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/guideStyle.css">
</head>

<body>

    <div class="engloba">

        <%- include ('partials/menuLateral.ejs'); %>

            <div class="wrapper pesquisa2">

                <br>

                <h3>Pacientes</h3>

                <div class="pesquisaPacientes">

                    <input id="txtBusca" class="input-pesquisa form-control" placeholder="Digite sua pesquisa">

                    <table class="table table-bordered tabelaPacientes">
                        <thead>
                            <tr>
                                <th scope="col">Nome</th>
                                <th scope="col">E-mail</th>
                                <th scope="col">Cpf</th>
                                <th scope="col">Cidade</th>
                            </tr>
                        </thead>
                        <tbody id="tbody">
                            <% pacientes.forEach(paciente=> {%>
                                <tr>
                                    <td><a id="nomePacBusc" href="/pacientes/perfil/<%= paciente.id %>">
                                            <%= paciente.nome %>
                                        </a></td>
                                    <td>
                                        <%= paciente.email %>
                                    </td>
                                    <td>
                                        <%= paciente.cpf %>
                                    </td>
                                    <td>
                                        <%= paciente.cidade %>
                                    </td>
                                </tr>
                                <% }); %>
                        </tbody>
                    </table>

                </div>

            </div>
    </div>

    <script>
        var tbody = document.getElementById("tbody");
        var tr = tbody.children;
        console.log(tr);

        document.getElementById("txtBusca").addEventListener("keyup", function () {
            var busca = document.getElementById("txtBusca").value.toLowerCase();

            for (var i = 0; i < tbody.children.length; i++) {
                var achou = false;
                var tr = tbody.children[i];
                var td = tr.children;
                console.log(td);

                for (var j = 0; j < td.length; j++) {
                    var value = td[j].innerText.toLowerCase();

                    if (value.indexOf(busca) >= 0) {
                        achou = true;
                    }
                }

                if (achou == true) {
                    tr.style.display = "table-row";
                } else {
                    tr.style.display = "none";
                }
            }
        });
    </script>

</body>

</html>